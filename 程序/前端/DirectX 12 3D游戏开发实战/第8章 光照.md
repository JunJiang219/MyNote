# 8.1 光照与材质的交互
在开启光照的同时，我们不再直接指出顶点的颜色，而是指定材质与光照，再运用光照方程（ lighting equation ）基于两者的交互来计算顶点颜色。这样做会使物体的颜色更趋于真实。

我们可以把材质看作是确定光照与物体表面如何进行交互的属性集。此属性集中的属性有：**==表面反射光==** 和 **==可吸收光的颜色==**、**==表面下材质的折射率==**、**==表面的光滑度==** 以及 **==表面的透明度==**。

当光线从光源发出向外传播并触碰到某个物体时，**==一部分光线可能会被吸收==**，而 **==另一部分光线则将被反射==**（ 对于玻璃这类透明物体，**==部分光线能透过介质==**（medium，也作媒介），但我们暂不考虑这种情况 ）。被反射的光线会沿着它的新路径传播，并有可能再次碰到其他物体，发生二次吸收与反射。因此，会发生这样一种情况，那就是光线在碰到足够多的物体后被完全吸收了。而一些剩余的光线最终可能会传入观察者的眼中并照射到视网膜上感光细胞。

根据 **==三色论（ trichromatic theory，又称三色说 ）==**，视网膜含有 3 种光受体，分别对红、绿、蓝三色光敏感（ 有部分重叠 ）。RGB 入射光刺激其相应的光受体，基于光线的强度而产生不同程度的刺激。

# 8.2 法向量
![[Pasted image 20240814131046.png]]
![[Pasted image 20240814132116.png]]

## 8.2.1 计算法向量
![[Pasted image 20240814135618.png]]
![[Pasted image 20240814135655.png]]

## 8.2.2 变换法向量
![[Pasted image 20240814143535.png]]
![[Pasted image 20240814143559.png]]
![[Pasted image 20240814144147.png]]

> [!NOTE] 注意
> 尽管运用了逆转置变换，但法向量仍可能失去其长度。所以在变换完成后，可能需对它再次进行规范化处理。


# 8.3 参与光照计算的一些关键向量
![[Pasted image 20240814151323.png]]
![[Pasted image 20240814151336.png]]

# 8.4 朗伯余弦定理
我们可以将光看做是光子的集合，在空间中按特定的方向传播。每个光子都载有（光）能量。光源每秒发出的（光）能量称为 **==辐射通量（radiant flux）==**。而单位面积上的辐射通量密度（irradiance，称为 **==辐（射）照度==**）是一种很重要的概念，因为我们将用它来确定表面某区域接收到的光量（即眼睛感受到的明亮度）。
![[Pasted image 20240814195749.png]]

换句话说，面积 $A_2$ 内的辐照度就相当于将受垂直方向光照的面积 $A_1$ 内的辐照度按比例 $n \cdot L = cos\theta$ 进行缩放。这就是传说中的 **==朗伯余弦定理（Lambert's Cosine Law）==**。考虑到光线照射到表面另一侧的情况（此时，点积的结果为负值），我们用 max 函数来钳制 “缩放因子” 的取值范围：
$$
f(\theta) = max(cos\theta, 0) = max(L \cdot n, 0)
$$
图 8.11 所示的是函数 $f(\theta)$ 的图像。观察可知，随着变量 $\theta$ 的变化，函数的值域范围为 0.0~1.0（即光照强度的变化范围为 0%~100%）。
![[Pasted image 20240814201127.png]]
![[Pasted image 20240814201313.png]]

# 8.5 漫反射光照
考虑图 8.12 所示的不透明物体表面。当光线照射到表面上某一点时，一部分光会进入物体的内部，并与表面附近的物质相互作用。这些光会在物体内部四处反弹，一部分被吸收，余下部分则会向各个方向散射并返回表面，这就是所谓的 **==漫反射（diffuse reflection）==**。
![[Pasted image 20240826181240.png]]

我们将漫反射光照的计算分为两个部分。在第一部分中，我们要指定光照颜色以及 **==漫反射反照率==**（diffuse albedo）颜色。漫反射反照率表示的是根据表面的 **==漫反射率==**（diffuse reflectance，也译作漫反射比）而被反射的入射光量。要对它们进行处理就需要分量式颜色乘法。例如，假设表面上一点会反射 50% 的入射红光、100% 的绿光和 75% 的蓝光，如果这时有一束强度为 80% 的白光袭来，那么此入射光的量值就可以表示为 $B_L = (0.8, 0.8, 0.8)$ ，又因为漫反射反照率为 $m_d = (0.5, 1.0, 0.75)$ ，所以此点的反射光量为：
$$
c_d = B_L \otimes m_d = (0.8, 0.8, 0.8) \otimes (0.5, 1.0, 0.75) = (0.4, 0.8, 0.6)
$$
然而，上述公式并非十分准确，我们还需将朗伯余弦定律（根据表面向量与光向量夹角来控制表面接收原始光照的量）考虑在内。设 $B_L$ 表示入射光量， $m_d$ 为漫反射反照率，$L$ 为光向量，$n$ 为表面法线，则位于表面上某点处的漫反射光量为：
$$
c_d = max(L \cdot n, 0) \cdot B_L \otimes m_d
$$

# 8.6 环境光照
